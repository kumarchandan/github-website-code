{"componentChunkName":"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js","path":"/blog/natural-language-processing/LSTMs-GRUs-&-Attention-Blocks/","result":{"data":{"site":{"siteMetadata":{"title":"Chandan Kumar","social":[{"name":"Twitter","url":"https://twitter.com/enchandan"},{"name":"GitHub","url":"https://github.com/kumarchandan"},{"name":"LinkedIn","url":"https://www.linkedin.com/in/enchandan/"}]}},"blogPost":{"__typename":"MdxBlogPost","id":"bd0cc129-30df-5a1d-8d4e-9fd776fea217","excerpt":"LSTMs The idea of LSTMs (Long Short-term Memory Networks) is closely related to the fact that we, humans, understand the context when we…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"LSTMs GRUs & Attention Blocks\",\n  \"date\": \"2020-12-03T00:00:00.000Z\",\n  \"imageAlt\": \"Day 3\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, [\"components\"]);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"lstms\"\n  }, mdx(\"strong\", {\n    parentName: \"h1\"\n  }, \"LSTMs\")), mdx(\"p\", null, \"The idea of LSTMs (Long Short-term Memory Networks) is closely related to the fact that we, humans, understand the context when we talk. And, there is no way a traditional neural network can help in storing this context. So Recurrent neural networks (RNNs) were invented to tackle this problem. These are networks with a recurring nature that allows information to persist.\"), mdx(\"p\", null, \"A simple RNN looks like this:\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"885px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.710144927536234%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+UlEQVQoz42S207DMAyG9/6vxwWiFCEGWzrSNIlzcBx3BReJY7eWX7mJ48+/YntXSqGFKlHMaEKi6xJwN6f+lgTOI59cuHl4Epo/w4s0+gtzZeZRVJBNjzzO1/lUXofFhIfYm6h9tsaavjM2Di4NQ9QuW3mlH/5LZ4FNppQAkyOEGoeCuYQcTOi3YQ0nQJ98Dj4Yq5PDjDkQALppetv4c0Jx9d4BOOhejwIflbp/vHt+2SulpMNrsJhLd0qo5EeCieCsDqpt26ZppOSG85cwlqjxe/K1ygj+BTPXiNQ7JK7XdBn+WJKxs/52f0hUeQW+uJ6ijMXGjfV8B1Zbt54TRaqPAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"1UOKamqFOlHJ2mkWJ1kL-RA.png\",\n    \"title\": \"1UOKamqFOlHJ2mkWJ1kL-RA.png\",\n    \"src\": \"/static/dcf51126fa4fac2ab2bc84ff323581da/efc66/1UOKamqFOlHJ2mkWJ1kL-RA.png\",\n    \"srcSet\": [\"/static/dcf51126fa4fac2ab2bc84ff323581da/e4d6b/1UOKamqFOlHJ2mkWJ1kL-RA.png 345w\", \"/static/dcf51126fa4fac2ab2bc84ff323581da/1e043/1UOKamqFOlHJ2mkWJ1kL-RA.png 690w\", \"/static/dcf51126fa4fac2ab2bc84ff323581da/efc66/1UOKamqFOlHJ2mkWJ1kL-RA.png 885w\"],\n    \"sizes\": \"(max-width: 885px) 100vw, 885px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"A Simple RNN\"), mdx(\"p\", null, \"It takes an input x and outputs ahidden state h. It also has another output which also goes as input to the RNN block. This way it has the ability to connect previous information to the current task. Though simple RNNs fail when it comes to understanding longer sequences of texts.\"), mdx(\"p\", null, \"LSTMs are a special kind of RNN. It covers up the shortcomings of a simple RNN which is good for a short sequence of information.\"), mdx(\"p\", null, \"LSTMs are capable of learning long-term dependencies. Its key part is - Cell state. The horizontal green line running in the below picture. It holds information on previous input sequences.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"44.63768115942029%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGElEQVQoz41Q2XKDMAzk/z+wj+2kpBwpYHzpNEzkkJA+ViMLSWa18jbMnHNGQuKnpxzP3Poh+PctIQtZJ8UkIo0dt7iQQgBv7mHtfvqQQ4QQsTa7ax9fpQ+h/pk9IlawMZdSVPR0ilITMxYGXW9Bpdq2bdfva3tp93230oDN8ZE/RkkfHcXIEGkeVyttlGCZhmV1a+U6wG+kSlFNiB+frZTSjtOlv5V9++pmEGmH6dJNyeUUkh5geTADABObKFUf5KH3NtAteZ4Sk/yOph+7OTufBZWSHHTPtZ1bIGFcspu83VEQW9giRa6JP6IoKwGD5xzRe/8SzPYoYuQQ0ZKHXDWeyaHk83Eqp0wNkS1VzdS3efw/q7oS3QEIogfA7No6WQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"1YS1G3zRg-yB3KN1euR3HCA.png\",\n    \"title\": \"1YS1G3zRg-yB3KN1euR3HCA.png\",\n    \"src\": \"/static/3f5a4bcd9d179527f91de3781a1b922c/b1001/1YS1G3zRg-yB3KN1euR3HCA.png\",\n    \"srcSet\": [\"/static/3f5a4bcd9d179527f91de3781a1b922c/e4d6b/1YS1G3zRg-yB3KN1euR3HCA.png 345w\", \"/static/3f5a4bcd9d179527f91de3781a1b922c/1e043/1YS1G3zRg-yB3KN1euR3HCA.png 690w\", \"/static/3f5a4bcd9d179527f91de3781a1b922c/b1001/1YS1G3zRg-yB3KN1euR3HCA.png 1380w\", \"/static/3f5a4bcd9d179527f91de3781a1b922c/10ab7/1YS1G3zRg-yB3KN1euR3HCA.png 1552w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"An LSTM Block\"), mdx(\"p\", null, \"Process of LSTMs can be understood in the following 4 steps:\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 1\"), \" - Throw away what\\u2019s not needed\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"680px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"69.85507246376812%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACnUlEQVQoz0WSz0sVURTHZ1EbF0UbV+3atUjaBQkZRBAEEQWRELSyFmG/f7iQLGyhRlSIzpu589P3fI/UfCZqP6yQXJhU6vPNvfN77vx6Zq+sP6Fz5xnBl+Hcufdzz7nfczjJCGUSKQaVDSphinAIEkmISBZkyyygCo50EuXNZNRMC1Y6YiYcwIqZKF5d9uqSsynBUYP+h0kogbJAxqFOYp0kComy3YiTcaRWqdrXpQ32yR8/IRwjZwM1thnWqIXCFeNuLW9G/wqB6yJOIbG85paunCgfbZrq65x8/1qem5XMmJEkYjDEZgynVTuBB4oZKTBFnIqpatXUVTvfc6ncfbHc06HdPK8sfZPsmmRQZCXSqolWTAHHua84qz9qkCLACg6ZbCg1QYtL0ocFAbTuM6vMiPl09ZzyrJf/YvLd11DVFVnyjDdCMIwW7XTMjsfcdDz8+SL89TLemvA3dCiVxOKaI87O6bfahfkF5UY7MgLBTFjZRsxgaNKIlYzaSckBpQU7KTpp0Ul0K/OGhAL9M3L9rDJRkksaGurPeXUR2mEkDJZxADZAGyQCxkaZKPzMlqFY9QX6W396v/DgcsfA4OPDzdrMq5xbF9YDwaAAU+ibSuDLtB2wkQhEQsWqJwRbeX1IutB693TraNuuYudJvkqB5Ks+p2zDbM5UBgeNrmYdDiBzzvuRnxp7dGTvnbaWgeMHnxzaoxbEYXeTr7jw5kAjMDrbmWUCBTMeBG8TwCErFRc/a2dayl0HZvr3T9/eh3rv8e734YoDbvsaoVo2g42RlLAvEyYIRMMXCOVX3OmHp/x3u+niTjzZjMaLw1bKrzscMnxWIdgDOTHkBDFMwp6KHQRvNrxcJVh+e8ye5/B8k/lmR3F58rlR4yv2X5j9Ynsgzby8AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"0ElVZHjrZqPa-v-iO.png\",\n    \"title\": \"0ElVZHjrZqPa-v-iO.png\",\n    \"src\": \"/static/a1be5d2e6839d3b13bb68649c21c23c7/c5bb3/0ElVZHjrZqPa-v-iO.png\",\n    \"srcSet\": [\"/static/a1be5d2e6839d3b13bb68649c21c23c7/e4d6b/0ElVZHjrZqPa-v-iO.png 345w\", \"/static/a1be5d2e6839d3b13bb68649c21c23c7/c5bb3/0ElVZHjrZqPa-v-iO.png 680w\"],\n    \"sizes\": \"(max-width: 680px) 100vw, 680px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Source: KnowYourMeme\"), mdx(\"p\", null, \"The incoming Cell state contains information about the whole input sequence up to that moment. The first task is to figure out what information to be thrown away from the Cell state. This decision is taken using a sigmoid layer called the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Forget gate\"), \". It looks at the incoming input and the hidden state and produces numbers between 0 and 1. Values reaching towards 0 will be the ones that should be forgotten.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 2\"), \" - Compute and keep what\\u2019s needed\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1024px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"82.6086956521739%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAARABQDASIAAhEBAxEB/8QAGQABAAMBAQAAAAAAAAAAAAAAAAECBQME/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAEDAv/aAAwDAQACEAMQAAABy+lJnSqDz59ETuA//8QAGhABAQEBAAMAAAAAAAAAAAAAAQIAERIhMv/aAAgBAQABBQJo1HdUovjq9r0TV8u//8QAFREBAQAAAAAAAAAAAAAAAAAAEAL/2gAIAQMBAT8BJP/EABURAQEAAAAAAAAAAAAAAAAAABAC/9oACAECAQE/ASj/xAAXEAADAQAAAAAAAAAAAAAAAAAAARAC/9oACAEBAAY/AjNVQj//xAAcEAACAgIDAAAAAAAAAAAAAAAAARExQXEQUWH/2gAIAQEAAT8hrzI5ZUssoE6HTqxG4q9FgMw4NND/2gAMAwEAAgADAAAAEJDw/wD/xAAXEQADAQAAAAAAAAAAAAAAAAAAATEQ/9oACAEDAQE/EFB5dP/EABYRAQEBAAAAAAAAAAAAAAAAAAABMf/aAAgBAgEBPxBG4mP/xAAcEAEAAgMAAwAAAAAAAAAAAAABABEhMaFxscH/2gAIAQEAAT8QUIDU1mZYgVVyUoYSxDSSsurlio1K0M2DUvQ6xSok28pyHqcf7P/Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"0qWGCKriL7pvUauPF.jpg\",\n    \"title\": \"0qWGCKriL7pvUauPF.jpg\",\n    \"src\": \"/static/e7cc9d5555019c1fd011142f314d5354/72e01/0qWGCKriL7pvUauPF.jpg\",\n    \"srcSet\": [\"/static/e7cc9d5555019c1fd011142f314d5354/8d48c/0qWGCKriL7pvUauPF.jpg 345w\", \"/static/e7cc9d5555019c1fd011142f314d5354/15ec7/0qWGCKriL7pvUauPF.jpg 690w\", \"/static/e7cc9d5555019c1fd011142f314d5354/72e01/0qWGCKriL7pvUauPF.jpg 1024w\"],\n    \"sizes\": \"(max-width: 1024px) 100vw, 1024px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Source: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.reddit.com/r/TheHobbitFaction/comments/9b4lmd/the_elves_are_here_to_honor_the_alliance_with_a/\"\n  }), \"Reddit\")), mdx(\"p\", null, \"This is done by the part called the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Input gate\"), \".\"), mdx(\"p\", null, \"It has two parts, the first one is a Sigmoid layer and another is a tanh layer. Both of them figure out what information will be updated to the Cell state.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 3\"), \" - Update the Cell State\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"620px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.07246376811594%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAABA//EABYBAQEBAAAAAAAAAAAAAAAAAAMAAv/aAAwDAQACEAMQAAABLjjm/KRWP//EABkQAQEBAAMAAAAAAAAAAAAAAAECAAMRIv/aAAgBAQABBQI7kOSsGa8wBTe//8QAFxEBAAMAAAAAAAAAAAAAAAAAAhARIf/aAAgBAwEBPwEk1sf/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwFWf//EABgQAAIDAAAAAAAAAAAAAAAAAAABECEx/9oACAEBAAY/AqFF4ao//8QAHBAAAgMAAwEAAAAAAAAAAAAAAREAITFBUYGh/9oACAEBAAE/ISpF4YSgKYeZKs+QPG2uMJL1stoAz//aAAwDAQACAAMAAAAQOz//xAAXEQEBAQEAAAAAAAAAAAAAAAABAEGB/9oACAEDAQE/EHJxcv/EABcRAAMBAAAAAAAAAAAAAAAAAAABEWH/2gAIAQIBAT8QaZdP/8QAHBABAQACAgMAAAAAAAAAAAAAAREAMSFRkbHB/9oACAEBAAE/EHVLBXxbxIAHyitTWGMq1vL7j1ckAX0YCaAlHB71i3A7M//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"0o2I5WIsHgW4yd_t_.jpg\",\n    \"title\": \"0o2I5WIsHgW4yd_t_.jpg\",\n    \"src\": \"/static/a4d9f9a4e3b2b701ee61b3df5008f069/935bc/0o2I5WIsHgW4yd_t_.jpg\",\n    \"srcSet\": [\"/static/a4d9f9a4e3b2b701ee61b3df5008f069/8d48c/0o2I5WIsHgW4yd_t_.jpg 345w\", \"/static/a4d9f9a4e3b2b701ee61b3df5008f069/935bc/0o2I5WIsHgW4yd_t_.jpg 620w\"],\n    \"sizes\": \"(max-width: 620px) 100vw, 620px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Source: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://imgflip.com/i/1xbpmi\"\n  }), \"Imgflip\")), mdx(\"p\", null, \"Now is the time to update the old Cell state to a new Cell state using the values calculated in the previous step.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Step 4\"), \" - Compute what to output\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"640px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.07246376811594%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFAEBAAAAAAAAAAAAAAAAAAAAA//aAAwDAQACEAMQAAABCw2pqqDC3//EABsQAAICAwEAAAAAAAAAAAAAAAECERMAAyEi/9oACAEBAAEFAgSGmEvjC3fFa7ef/8QAFxEBAAMAAAAAAAAAAAAAAAAAAAERIf/aAAgBAwEBPwGaY//EABYRAQEBAAAAAAAAAAAAAAAAAAASIf/aAAgBAgEBPwHUv//EAB4QAAIBAwUAAAAAAAAAAAAAAAARARIiMQIhUWGR/9oACAEBAAY/AkslVGjY5L5SFXnoumPD/8QAHBAAAwACAwEAAAAAAAAAAAAAAAERITFRYXGx/9oACAEBAAE/IaMr7IWK+g0KehGdmkzRO96PPg//2gAMAwEAAgADAAAAEIAf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAREA/9oACAEDAQE/EIuFlu//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EDUs5l//xAAdEAEBAAMAAgMAAAAAAAAAAAABEQAhMUGhUWGB/9oACAEBAAE/EOKPHxndH3lk6Fpw2T3cUNgBRreGC3CjTu11jQkjYtvx6yRIOiLn5n//2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"0wXBpEo8MEFKfGGMh.jpg\",\n    \"title\": \"0wXBpEo8MEFKfGGMh.jpg\",\n    \"src\": \"/static/f86ec52db40d5b00ba00141d0be627e0/c08c5/0wXBpEo8MEFKfGGMh.jpg\",\n    \"srcSet\": [\"/static/f86ec52db40d5b00ba00141d0be627e0/8d48c/0wXBpEo8MEFKfGGMh.jpg 345w\", \"/static/f86ec52db40d5b00ba00141d0be627e0/c08c5/0wXBpEo8MEFKfGGMh.jpg 640w\"],\n    \"sizes\": \"(max-width: 640px) 100vw, 640px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Source: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.reddit.com/r/Texans/comments/j5u19z/looks_like_watching_the_games_is_back_on_the_menu/\"\n  }), \"Reddit\")), mdx(\"p\", null, \"Run a sigmoid layer to decide which part of the new Cell state to output. This process happens at the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Output gate\"), \".\"), mdx(\"p\", null, \"Put the new Cell state through tanh and multiply it by the output of the sigmoid function, so that only selected parts are in the output.\"), mdx(\"h1\", {\n    \"id\": \"grus\"\n  }, \"GRUs\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"50.14492753623189%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVQoz4WS62rDMAyF+/5vt39lMEY3EufmOLKsm+3BnKyMrSvr4RgsiQ/Jl5Oqmlk+VHLZDVQClkgZuULKAasVYkbEUor90KmtlmoFTDEpRgbo++Y4jc3LywW6PsLajd0MY/6tK0xEDbdsQJtnL1XEhLK4YUJOxOSnlY1b8hbeBz5Uc2Wlfuo2v2XNrdS/OViQwTYfay13On8H7cBJcIE5zDEhq4kfNqVMUfwUyi37ByZN0eB8eXdLyMWenl8hEbCcu1ntf7jUYXZzGMcRQkgq6gZILCoWA+cHnWsZu8k5J0k0GYEYZWuvo9bCB/Ax9weGRJEFjaNevamg3oG/PklT27QLX9c1Ie1XLXa1Hr6nT8XOQNLRMlP1AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"1mkLsVOtT7E-J00DGFHY1vQ.png\",\n    \"title\": \"1mkLsVOtT7E-J00DGFHY1vQ.png\",\n    \"src\": \"/static/02b15e01168f0197b469365c65fb997d/b1001/1mkLsVOtT7E-J00DGFHY1vQ.png\",\n    \"srcSet\": [\"/static/02b15e01168f0197b469365c65fb997d/e4d6b/1mkLsVOtT7E-J00DGFHY1vQ.png 345w\", \"/static/02b15e01168f0197b469365c65fb997d/1e043/1mkLsVOtT7E-J00DGFHY1vQ.png 690w\", \"/static/02b15e01168f0197b469365c65fb997d/b1001/1mkLsVOtT7E-J00DGFHY1vQ.png 1380w\", \"/static/02b15e01168f0197b469365c65fb997d/f4b34/1mkLsVOtT7E-J00DGFHY1vQ.png 1457w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"A GRU Block\"), mdx(\"p\", null, \"GRUs (Gated Recurrent Units) is the combination of both Peephole and Coupled Forget-Input LSTMs variants. You can read about these variants \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://colah.github.io/posts/2015-08-Understanding-LSTMs/\"\n  }), \"here\"), \".\"), mdx(\"p\", null, \"In its architecture, it combines the forget and input gate into a single \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"update gate\"), \". It also merges the cell state and hidden state, which is passed to both the gates as shown above in the picture. It works on the idea that more the information a network has, the better it will learn.\"), mdx(\"p\", null, \"In the normal LSTM, forgetting unnecessary information happens using the Forget gate, and adding new information is decided by the Input gate. Both the operation can be handled at once. The idea is that if you have set aside the information to be forgotten, the rest of the information is to be stored, so use that. From this Coupled Forget-Input gate, the input to the Input gate is inverse of the Forget gate. This idea is referred to as Yin Yang.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"LSTMs vs GRUs\")), mdx(\"p\", null, \"There are no research papers claiming that GRUs are better than LSTMs. Though people prefer GRU because it uses less number of neural network which leads to less number of parameters and faster training time.\"), mdx(\"h1\", {\n    \"id\": \"attention\"\n  }, \"Attention\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"599px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJElEQVQozwEZA+b8AFJDK1pKMmJQN2JPMaqmoMLFypyak6+uqMbIzbi5ucvMy7q8vrW3uLu9vL2/wZ2WjltHLkY3IDEkEzEkFgBaSTJjUTlpWDxxXj6Ngm2akoKWjXuSh3KakoGclH58dmpzaWOUjIOKhH5/enZrX1VnUTdQPyg2KBU0JxcAX082aFc9cGBBemdGgGtIgWtIgm5Kg3BNgnFKeWlFQjMimHZTj3JYTDksMCIZMiQbZ1M8WkgvOiwXNyoXAGNSOW1cQHZmRYFtTIdyUoh1VIh4VYl5VYp7VoFyUEU4KZR7YKGBYW5ZSHtqV1pNPm1ZQ2RRNj4wGTksGQBlVTtxX0N7a0qFclCIdlOJeVWLelaLfFWLflWMfVVURjaXdVyYd1qlhGmzoIXx4sKqknJlUDZDNR06LRkAaFg+dGJFfm5Mh3ZTiHhVinpVjH1WjH9WjH9XkIFYWlBBZEw8x4pwk21WqJR78N7Al35iXUgxSzwjOy8aAGhYPnNjRn9vTYh3VIl5Vot7Vox9V41/V46AWJCCWWhaRjApJ3pgSIZhRTYkGci9o7qigycVDDgtHz0vGwBmVj1xYER9bUuGdlOJeVaLe1iLfVeNf1mNf1qPglpsWUE0JyJvXkmniWdHMyVaSTz+8M1qV0MaExE6LyAAZVQ8cGBFfGxOhndUintXi3tYjX1ZjX5Zj4FagHNRVkAwOSUZlYBpvqOCdF1LPicbyrqf2suooI9wmYNgAFxNNWFONmVRN3BbP3hmR35uTYFxUIJxT4Z0UWpYQFQ/NEErH2tQPMmvioFoUT0mHIJvXeziwtXBmLSVbQBKNCJKMiBTOSRaPSlkRzBqUDehmpCkn5mlnpirpJ6loJyZlJCnoZ27saN3XEVMNStbRDfOwqXQxKOvk20AQiscTTYlWkEsXUItYkUvdVtEu7y8rrC0paeqvsDDqq2utba32tzelpSUTzouUT40Lx4XmIhw0sepsJ18ADspHEIvIlhAL1c/K1g9K2VMOHRkVHloWXRlV6iXhKeXhVlOSUxJR0VDPzwxKk8+NyIZE1dMPcW2maqaf1z4QmPdmx6KAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"15ez14Ef72Nyp3MEpZEILmA.png\",\n    \"title\": \"15ez14Ef72Nyp3MEpZEILmA.png\",\n    \"src\": \"/static/15bcb809e5fe15d9c23f11ab733b2ac4/43142/15ez14Ef72Nyp3MEpZEILmA.png\",\n    \"srcSet\": [\"/static/15bcb809e5fe15d9c23f11ab733b2ac4/e4d6b/15ez14Ef72Nyp3MEpZEILmA.png 345w\", \"/static/15bcb809e5fe15d9c23f11ab733b2ac4/43142/15ez14Ef72Nyp3MEpZEILmA.png 599w\"],\n    \"sizes\": \"(max-width: 599px) 100vw, 599px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"In NLP tasks such as sentiment analysis, we only need to focus on the final output, where LSTMs/GRUs perform well. Though there are NLP tasks like Language translation where every output matters and LSTMs/GRUs do not perform that great there.\"), mdx(\"p\", null, \"Attention mechanism comes to the rescue. It works with a set of encoders and decoders to handle the complexity of these tasks.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1380px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"59.130434782608695%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAABW0lEQVQoz21S2XLDMAjM/39inzrThzixdSHQAepMV3aSJm0YjYWFFnZBp/7PVNXMaqkiBQ4z47DWKiwIPd886ZPZbq01+JFjylFNfXJS5Pi18a1j4N5x//SA4Yv0qJNzjhSlCZXk0mZDL/4sjYuJEusaNPHEH5UnyVqJCMRQ1tRab5G9pw0Y4ElSzB7FDaK4aJ3UbmARQbWpFrihEJsoxRRDDCyyuY0o40SEJ8E750m7lALkGAMBKjGQizmgbLc2bB4eocP01U7gCTCkwgniL9uyrOerX5pWCNr78ein/gUf25zEzhALbDNnjAoZEco0fRBER36L9yfwreFdj4YBtvrr6lfKdHUXF5ByJU4GTKlo1RyYvs75zs5IiNtckUM1CeykZTHMKerHl34u6uk9eGehGA8W2hay61aJYxZCXm19jqrWSbu/MwTKbnBSIiiCYLxWZO273j7fSP8BSxO15wx30T4AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"1km_Vb_XouZ0BlWD5EGCI1A.png\",\n    \"title\": \"1km_Vb_XouZ0BlWD5EGCI1A.png\",\n    \"src\": \"/static/93430de56dd91fbe80afe60fc3bac89d/b1001/1km_Vb_XouZ0BlWD5EGCI1A.png\",\n    \"srcSet\": [\"/static/93430de56dd91fbe80afe60fc3bac89d/e4d6b/1km_Vb_XouZ0BlWD5EGCI1A.png 345w\", \"/static/93430de56dd91fbe80afe60fc3bac89d/1e043/1km_Vb_XouZ0BlWD5EGCI1A.png 690w\", \"/static/93430de56dd91fbe80afe60fc3bac89d/b1001/1km_Vb_XouZ0BlWD5EGCI1A.png 1380w\", \"/static/93430de56dd91fbe80afe60fc3bac89d/80cfc/1km_Vb_XouZ0BlWD5EGCI1A.png 1844w\"],\n    \"sizes\": \"(max-width: 1380px) 100vw, 1380px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"Attention is all you need!\"), mdx(\"p\", null, \"It has a part called \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"context vector\"), \" that enables the decoder to focus on certain parts of the input while it predicts the output. Each context vector is a weighted sum of the outputs (h1, h2, h3) of the encoders.\"), mdx(\"p\", null, \"To get the context vectors (c1, c2, c3), the Attention layer looks at all the values of h states and incoming values of s.\"), mdx(\"p\", null, \"More details on Attention will come in the next part. So stay tuned!\"));\n}\n;\nMDXContent.isMDXComponent = true;","slug":"/blog/natural-language-processing/LSTMs-GRUs-&-Attention-Blocks/","title":"LSTMs GRUs & Attention Blocks","tags":[],"date":"December 03, 2020","image":null,"imageAlt":"Day 3","imageCaptionText":null,"imageCaptionLink":null,"socialImage":null},"previous":{"__typename":"MdxBlogPost","id":"aa6e92e8-4c04-54e0-9e1d-bf81745238ab","excerpt":"Introduction There are several methods for weight update available. These are called  optimizers . Gradient descent optimization algorithm…","slug":"/blog/100-days-of-deep-learning/day3-gradient-descent/","title":"Gradient Descent","date":"October 12, 2020"},"next":null},"pageContext":{"id":"bd0cc129-30df-5a1d-8d4e-9fd776fea217","previousId":"aa6e92e8-4c04-54e0-9e1d-bf81745238ab","maxWidth":1380}},"staticQueryHashes":["2744905544","3090755652","386998304","764694655"]}